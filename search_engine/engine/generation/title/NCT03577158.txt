SAFE-AP: Automatic Control of Blood Glucose Under Announced and Unannounced Exercise